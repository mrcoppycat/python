CREATE DATABASE ALL1;
USE ALL1;
CREATE TABLE PUBLISHER
(NAME VARCHAR (20) PRIMARY KEY,
PHONE INTEGER,
ADDRESS VARCHAR (20));


CREATE TABLE BOOK
(BOOK_ID INTEGER PRIMARY KEY,
TITLE VARCHAR(20),
PUB_YEAR VARCHAR(20),
PUBLISHER_NAME VARCHAR(20),
FOREIGN KEY(PUBLISHER_NAME) REFERENCES PUBLISHER (NAME) ON DELETE CASCADE);



CREATE TABLE BOOK_AUTHORS (AUTHOR_NAME
VARCHAR (20),
BOOK_ID INTEGER,
FOREIGN KEY(BOOK_ID) REFERENCES
BOOK(BOOK_ID) ON DELETE CASCADE,
PRIMARY KEY (BOOK_ID, AUTHOR_NAME));



CREATE TABLE LIBRARY_PROGRAMME
(PROGRAMME_ID INTEGER PRIMARY KEY,
PROGRAMME_NAME VARCHAR(50),
ADDRESS VARCHAR (50));




CREATE TABLE BOOK_COPIES(NO_OF_COPIES INTEGER,
BOOK_ID INTEGER ,
FOREIGN KEY(BOOK_ID) REFERENCES BOOK (BOOK_ID) ON DELETE CASCADE,
PROGRAMME_ID INTEGER,
FOREIGN KEY(PROGRAMME_ID) REFERENCES LIBRARY_PROGRAMME
(PROGRAMME_ID) ON DELETE CASCADE,
PRIMARY KEY (BOOK_ID, PROGRAMME_ID));



CREATE TABLE CARD
(CARD_NO INTEGER PRIMARY KEY);


CREATE TABLE BOOK_LENDING
(DATE_OUT DATE,
DUE_DATE DATE,
BOOK_ID INTEGER,
FOREIGN KEY(BOOK_ID) REFERENCES BOOK (BOOK_ID) ON DELETE CASCADE,
PROGRAMME_ID INTEGER,
FOREIGN KEY(PROGRAMME_ID) REFERENCES LIBRARY_PROGRAMME
(PROGRAMME_ID) ON DELETE CASCADE,
CARD_NO INTEGER);




INSERT INTO PUBLISHER VALUES ("MCGRAW-HILL", 998907658, "BANGALORE");
INSERT INTO PUBLISHER VALUES ("PEARSON", 988907656, "NEWDELHI");
INSERT INTO PUBLISHER VALUES ("RANDOM HOUSE", 745567934, "HYDRABAD");
INSERT INTO PUBLISHER VALUES ("HACHETTE LIVRE", 897086234, "CHENAI");
INSERT INTO PUBLISHER VALUES ("GRUPO PLANETA", 775612023, "BANGALORE");

INSERT INTO BOOK VALUES (1,"DBMS","JAN-2017", "MCGRAW-HILL");
INSERT INTO BOOK VALUES (2,"ADBMS","JUN-2016", "MCGRAW-HILL");
INSERT INTO BOOK VALUES (3,"CN","SEP-2016", "PEARSON");
INSERT INTO BOOK VALUES (4,"CG","SEP-2015", "GRUPO PLANETA");
INSERT INTO BOOK VALUES (5,"OS","MAY-2016", "PEARSON");

INSERT INTO BOOK_AUTHORS VALUES ("NAVATHE", 1);
INSERT INTO BOOK_AUTHORS VALUES ("NAVATHE", 2);
INSERT INTO BOOK_AUTHORS VALUES ("TANENBAUM", 3);
INSERT INTO BOOK_AUTHORS VALUES ("EDWARD ANGEL", 4);
INSERT INTO BOOK_AUTHORS VALUES ("GALVIN", 5);

INSERT INTO LIBRARY_PROGRAMME VALUES (11,"APSCE","BANGALORE");
INSERT INTO LIBRARY_PROGRAMME VALUES (12,"N R COLONY","BANGALORE");
INSERT INTO LIBRARY_PROGRAMME VALUES (13,"NITTE","MANGALORE");
INSERT INTO LIBRARY_PROGRAMME VALUES (14,"MANIPAL","UDUPI");
INSERT INTO LIBRARY_PROGRAMME VALUES (10,"RRNAGAR","BANGALORE");

INSERT INTO BOOK_COPIES VALUES (10,1, 10);
INSERT INTO BOOK_COPIES VALUES (5,1, 11);
INSERT INTO BOOK_COPIES VALUES (2,2, 12);
INSERT INTO BOOK_COPIES VALUES (5,2, 13);
INSERT INTO BOOK_COPIES VALUES (7,3, 14);
INSERT INTO BOOK_COPIES VALUES (1,5, 10);
INSERT INTO BOOK_COPIES VALUES (3,4, 11);

INSERT INTO BOOK_LENDING VALUES ("2017-01-01","2017-06-01", 1, 10, 101);
INSERT INTO BOOK_LENDING VALUES ("2017-01-11","2017-03-11", 3, 14, 101);
INSERT INTO BOOK_LENDING VALUES ("2017-02-21","2017-04-21", 2, 13, 101);
INSERT INTO BOOK_LENDING VALUES ("2017-03-15","2017-07-15", 4, 11, 101);
INSERT INTO BOOK_LENDING VALUES ("2017-04-12","2017-05-12", 1, 11, 104);




SELECT B.BOOK_ID, B.TITLE, B.PUBLISHER_NAME, A.AUTHOR_NAME,
C.NO_OF_COPIES, L.PROGRAMME_ID
FROM BOOK B, BOOK_AUTHORS A, BOOK_COPIES C, LIBRARY_PROGRAMME L
WHERE B.BOOK_ID=A.BOOK_ID
AND B.BOOK_ID=C.BOOK_ID
AND L.PROGRAMME_ID=C.PROGRAMME_ID;


SELECT CARD_NO
FROM BOOK_LENDING
WHERE DATE_OUT BETWEEN "2017-01-01" AND "2017-07-01"
GROUP BY CARD_NO
HAVING COUNT(*)>3;


DELETE FROM BOOK
WHERE BOOK_ID=3;


CREATE VIEW V_PUBLICATION AS
SELECT PUB_YEAR
FROM BOOK;


CREATE VIEW V_BOOKS AS
SELECT B.BOOK_ID, B.TITLE, C.NO_OF_COPIES
FROM BOOK B, BOOK_COPIES C,
LIBRARY_PROGRAMME L
WHERE B.BOOK_ID=C.BOOK_ID AND
C.PROGRAMME_ID=L.PROGRAMME_ID;
COMMIT;





























CREATE DATABASE ALL2;
USE ALL2;

CREATE TABLE SALESMAN
(SALESMAN_ID INT(4),
NAME VARCHAR(20),
CITY VARCHAR(20),
COMMISSION VARCHAR(20),
PRIMARY KEY(SALESMAN_ID));


CREATE TABLE CUSTOMER
(CUSTOMER_ID INT(4),
CUST_NAME VARCHAR(20),
CITY VARCHAR(20), GRADE INT(3),
PRIMARY KEY (CUSTOMER_ID), SALESMAN_ID INTEGER,
FOREIGN KEY(SALESMAN_ID) REFERENCES SALESMAN(SALESMAN_ID) ON DELETE SET NULL);


CREATE TABLE ORDERS
(ORD_NO INT(5),
PURCHASE_AMT FLOAT(10, 2),
ORD_DATE DATE,
PRIMARY KEY
(ORD_NO),CUSTOMER_ID INTEGER,
FOREIGN KEY(CUSTOMER_ID) REFERENCES CUSTOMER (CUSTOMER_ID) ON DELETE CASCADE,SALESMAN_ID INT,
FOREIGN KEY(SALESMAN_ID)REFERENCES SALESMAN(SALESMAN_ID) ON DELETE CASCADE);







INSERT INTO SALESMAN VALUES (1000, "JOHN","BANGALORE","25 %");
INSERT INTO SALESMAN VALUES (2000, "RAVI","BANGALORE","20 %");
INSERT INTO SALESMAN VALUES (3000, "KUMAR","MYSORE","15 %");
INSERT INTO SALESMAN VALUES (4000, "SMITH","DELHI","30 %");
INSERT INTO SALESMAN VALUES (5000, "HARSHA","HYDRABAD","15 %");

INSERT INTO CUSTOMER VALUES (10, "PREETHI","BANGALORE", 100, 1000);
INSERT INTO CUSTOMER VALUES (11, "VIVEK","MANGALORE", 300, 1000);
INSERT INTO CUSTOMER VALUES (12, "BHASKAR","CHENNAI", 400, 2000);
INSERT INTO CUSTOMER VALUES (13, "CHETHAN","BANGALORE", 200, 2000);
INSERT INTO CUSTOMER VALUES (14, "MAMATHA","BANGALORE", 400, 3000);

INSERT INTO ORDERS VALUES (50, 5000, "2017-05-04", 10, 1000);
INSERT INTO ORDERS VALUES (51, 450, "2017-06-20", 10, 2000);
INSERT INTO ORDERS VALUES (52, 1000, "2017-02-24", 13, 2000);
INSERT INTO ORDERS VALUES (53, 3500, "2017-08-13", 14, 3000);
INSERT INTO ORDERS VALUES (54, 550, "2017-05-09", 12, 2000);



SELECT GRADE, COUNT(DISTINCT CUSTOMER_ID)
FROM CUSTOMER
GROUP BY GRADE
HAVING GRADE>(SELECT AVG(GRADE) FROM CUSTOMER
WHERE CITY="BANGALORE");


SELECT SALESMAN_ID, NAME
FROM SALESMAN A
WHERE 1<(SELECT COUNT(*)
FROM CUSTOMER
WHERE SALESMAN_ID=A.SALESMAN_ID);


SELECT SALESMAN.SALESMAN_ID, NAME, CUST_NAME, COMMISSION
FROM SALESMAN, CUSTOMER
WHERE SALESMAN.CITY = CUSTOMER.CITY
UNION
SELECT SALESMAN_ID,NAME, "NO MATCH", COMMISSION FROM SALESMAN
WHERE NOT CITY = ANY (SELECT CITY FROM CUSTOMER)
ORDER BY 2 DESC;


CREATE VIEW ELITSALESMAN AS
SELECT B.ORD_DATE, A.SALESMAN_ID, A.NAME
FROM SALESMAN A, ORDERS B
WHERE A.SALESMAN_ID = B.SALESMAN_ID
AND B.PURCHASE_AMT=(SELECT MAX(PURCHASE_AMT)
FROM ORDERS C
WHERE C.ORD_DATE = B.ORD_DATE);


DELETE FROM SALESMAN
WHERE SALESMAN_ID=1000;

COMMIT;































CREATE DATABASE ALL3;
USE ALL3;
CREATE TABLE ACTOR (
ACT_ID INT (3),
ACT_NAME VARCHAR (20),
ACT_GENDER CHAR (1),
PRIMARY KEY (ACT_ID));



CREATE TABLE DIRECTOR (
DIR_ID INT (3),
DIR_NAME VARCHAR (20),
DIR_PHONE INT (10),
PRIMARY KEY (DIR_ID));



CREATE TABLE MOVIES (
MOV_ID INT(4),
MOV_TITLE VARCHAR (25),
MOV_YEAR INT(4),
MOV_LANG VARCHAR (12),
DIR_ID INT(3),
PRIMARY KEY (MOV_ID),
FOREIGN KEY(DIR_ID) REFERENCES DIRECTOR (DIR_ID));



CREATE TABLE MOVIE_CAST (
ACT_ID INT (3),
MOV_ID INT (4),
ROLE VARCHAR (10),
PRIMARY KEY (ACT_ID, MOV_ID),
FOREIGN KEY (ACT_ID) REFERENCES ACTOR (ACT_ID),
FOREIGN KEY (MOV_ID) REFERENCES MOVIES (MOV_ID));




CREATE TABLE RATING (
MOV_ID INTEGER (4),
REV_STARS VARCHAR (25),
PRIMARY KEY (MOV_ID),
FOREIGN KEY (MOV_ID) REFERENCES MOVIES (MOV_ID));





INSERT INTO ACTOR VALUES (301,"ANUSHKA","F");
INSERT INTO ACTOR VALUES (302,"PRABHAS","M");
INSERT INTO ACTOR VALUES (303,"PUNITH","M");
INSERT INTO ACTOR VALUES (304,"JERMY","M");



INSERT INTO DIRECTOR VALUES (60,"RAJAMOULI", 875161100);
INSERT INTO DIRECTOR VALUES (61,"HITCHCOCK", 776613891);
INSERT INTO DIRECTOR VALUES (62,"FARAN", 998677653);
INSERT INTO DIRECTOR VALUES (63,"STEVEN SPIELBERG", 898977653);



INSERT INTO MOVIES VALUES (1001,"BAHUBALI-2", 2017, "TELAGU", 60);
INSERT INTO MOVIES VALUES (1002,"BAHUBALI-1", 2015, "TELAGU", 60);
INSERT INTO MOVIES VALUES (1003,"AKASH", 2008, "KANNADA", 61);
INSERT INTO MOVIES VALUES (1004,"WAR HORSE", 2011, "ENGLISH", 63);



INSERT INTO MOVIE_CAST VALUES (301, 1002, "HEROINE");
INSERT INTO MOVIE_CAST VALUES (301, 1001, "HEROINE");
INSERT INTO MOVIE_CAST VALUES (303, 1003, "HERO");
INSERT INTO MOVIE_CAST VALUES (303, 1002, "GUEST");
INSERT INTO MOVIE_CAST VALUES (304, 1004, "HERO");



INSERT INTO RATING VALUES (1001, 4);
INSERT INTO RATING VALUES (1002, 2);
INSERT INTO RATING VALUES (1003, 5);
INSERT INTO RATING VALUES (1004, 4);


SELECT MOV_TITLE
FROM MOVIES
WHERE DIR_ID IN (SELECT DIR_ID
FROM DIRECTOR
WHERE DIR_NAME = "HITCHCOCK");


SELECT MOV_TITLE
FROM MOVIES M, MOVIE_CAST MV
WHERE M.MOV_ID=MV.MOV_ID AND ACT_ID IN (SELECT ACT_ID
FROM MOVIE_CAST GROUP BY ACT_ID
HAVING COUNT(ACT_ID)>1)
GROUP BY MOV_TITLE
HAVING COUNT(*)>1;


SELECT ACT_NAME, MOV_TITLE, MOV_YEAR
FROM ACTOR A JOIN MOVIE_CAST C
ON A.ACT_ID=C.ACT_ID
JOIN MOVIES M
ON C.MOV_ID=M.MOV_ID
WHERE M.MOV_YEAR NOT BETWEEN 2000 AND 2015;


SELECT MOV_TITLE,MAX(REV_STARS)
FROM MOVIES
INNER JOIN RATING USING (MOV_ID)
GROUP BY MOV_TITLE
HAVING MAX(REV_STARS)>0
ORDER BY MOV_TITLE;



UPDATE RATING
SET REV_STARS=5
WHERE MOV_ID IN (SELECT MOV_ID FROM MOVIES
WHERE DIR_ID IN (SELECT DIR_ID FROM DIRECTOR
WHERE DIR_NAME = "STEVEN SPIELBERG"));

COMMIT;





































CREATE DATABASE ALL4;
USE ALL4;

CREATE TABLE STUDENT (
USN VARCHAR (10) PRIMARY KEY, 
SNAME VARCHAR(25),
ADDRESS VARCHAR(25),
PHONE INT(10),
GENDER CHAR(1));




CREATE TABLE SEMSEC (
SSID VARCHAR (5) PRIMARY KEY, 
SEM INT(2),
SEC CHAR (1));




CREATE TABLE CLASS ( 
USN VARCHAR (10),
SSID VARCHAR (5), 
PRIMARY KEY (USN, SSID),
FOREIGN KEY (USN) REFERENCES STUDENT (USN), 
FOREIGN KEY (SSID) REFERENCES SEMSEC(SSID));




CREATE TABLE SUBJECT ( 
SUBCODE VARCHAR (8),
TITLE VARCHAR (20),
SEM INT (2),
CREDITS INT (2), 
PRIMARY KEY (SUBCODE));



CREATE TABLE IAMARKS ( 
USN VARCHAR (10),
SUBCODE VARCHAR (8),
SSID VARCHAR (5),
TEST1 INT (2),
TEST2 INT (2),
TEST3 INT (2),
FINALIA INT (2),
PRIMARY KEY (USN, SUBCODE, SSID),
FOREIGN KEY (USN) REFERENCES STUDENT (USN),
FOREIGN KEY (SUBCODE) REFERENCES SUBJECT (SUBCODE), 
FOREIGN KEY (SSID) REFERENCES SEMSEC (SSID));









INSERT INTO STUDENT VALUES ("1AP13CS020","AKSHAY","BELAGAVI", 887788122,"M");
INSERT INTO STUDENT VALUES ("1AP13CS062","SANDHYA","BENGALURU", 772229912,"F");
INSERT INTO STUDENT VALUES ("1AP13CS091","TEESHA","BENGALURU", 771212312,"F");
INSERT INTO STUDENT VALUES ("1AP13CS066","SUPRIYA","MANGALURU", 887881122,"F");
INSERT INTO STUDENT VALUES ("1AP14CS010","ABHAY","BENGALURU", 990211201,"M");
INSERT INTO STUDENT VALUES ("1AP14CS032","BHASKAR","BENGALURU", 923211099,"M");
INSERT INTO STUDENT VALUES ("1AP14CS025","ASMI","BENGALURU", 794737377,"F"); 
INSERT INTO STUDENT VALUES ("1AP15CS011","AJAY","TUMKUR", 984591341,"M"); 
INSERT INTO STUDENT VALUES ("1AP15CS029","CHITRA","DAVANGERE", 769672121,"F");
INSERT INTO STUDENT VALUES ("1AP15CS045","JEEVA","BELLARY", 994485121,"M"); 
INSERT INTO STUDENT VALUES ("1AP15CS091","SANTOSH","MANGALURU", 812332201,"M");
INSERT INTO STUDENT VALUES ("1AP16CS045","ISMAIL","KALBURGI", 990232201,"M");
INSERT INTO STUDENT VALUES ("1AP16CS088","SAMEERA","SHIMOGA", 990542212,"F");
INSERT INTO STUDENT VALUES ("1AP16CS122","VINAYAKA","CHIKAMAGALUR", 880880011,"M");






INSERT INTO SEMSEC VALUES ("CSE8A", 8,"A"); 
INSERT INTO SEMSEC VALUES ("CSE8B", 8,"B"); 
INSERT INTO SEMSEC VALUES ("CSE8C", 8,"C");
INSERT INTO SEMSEC VALUES ("CSE7A", 7,"A"); 
INSERT INTO SEMSEC VALUES ("CSE7B", 7,"B"); 
INSERT INTO SEMSEC VALUES ("CSE7C", 7,"C");
INSERT INTO SEMSEC VALUES ("CSE6A", 6,"A"); 
INSERT INTO SEMSEC VALUES ("CSE6B", 6,"B"); 
INSERT INTO SEMSEC VALUES ("CSE6C", 6,"C");
INSERT INTO SEMSEC VALUES ("CSE5A", 5,"A"); 
INSERT INTO SEMSEC VALUES ("CSE5B", 5,"B"); 
INSERT INTO SEMSEC VALUES ("CSE5C", 5,"C");
INSERT INTO SEMSEC VALUES ("CSE4A", 4,"A"); 
INSERT INTO SEMSEC VALUES ("CSE4B", 4,"B"); 
INSERT INTO SEMSEC VALUES ("CSE4C", 4,"C");
INSERT INTO SEMSEC VALUES ("CSE3A", 3,"A"); 
INSERT INTO SEMSEC VALUES ("CSE3B", 3,"B"); 
INSERT INTO SEMSEC VALUES ("CSE3C", 3,"C");
INSERT INTO SEMSEC VALUES ("CSE2A", 2,"A"); 
INSERT INTO SEMSEC VALUES ("CSE2B", 2,"B");
INSERT INTO SEMSEC VALUES ("CSE2C", 2,"C"); 
INSERT INTO SEMSEC VALUES ("CSE1A", 1,"A"); 
INSERT INTO SEMSEC VALUES ("CSE1B", 1,"B"); 
INSERT INTO SEMSEC VALUES ("CSE1C", 1,"C");






INSERT INTO CLASS VALUES ("1AP13CS020","CSE8A"); 
INSERT INTO CLASS VALUES ("1AP13CS062","CSE8A"); 
INSERT INTO CLASS VALUES ("1AP13CS066","CSE8B"); 
INSERT INTO CLASS VALUES ("1AP13CS091","CSE8C");
INSERT INTO CLASS VALUES ("1AP14CS010","CSE7A"); 
INSERT INTO CLASS VALUES ("1AP14CS025","CSE7A"); 
INSERT INTO CLASS VALUES ("1AP14CS032","CSE7A");
INSERT INTO CLASS VALUES ("1AP15CS011","CSE4A"); 
INSERT INTO CLASS VALUES ("1AP15CS029","CSE4A"); 
INSERT INTO CLASS VALUES ("1AP15CS045","CSE4B"); 
INSERT INTO CLASS VALUES ("1AP15CS091","CSE4C");
INSERT INTO CLASS VALUES ("1AP16CS045","CSE3A"); 
INSERT INTO CLASS VALUES ("1AP16CS088","CSE3B"); 
INSERT INTO CLASS VALUES ("1AP16CS122","CSE3C");







INSERT INTO SUBJECT VALUES ("10CS81","ACA", 8, 4); 
INSERT INTO SUBJECT VALUES ("10CS82","SSM", 8, 4); 
INSERT INTO SUBJECT VALUES ("10CS83","NM", 8, 4); 
INSERT INTO SUBJECT VALUES ("10CS84","CC", 8, 4); 
INSERT INTO SUBJECT VALUES ("10CS85","PW", 8, 4);
INSERT INTO SUBJECT VALUES ("10CS71","OOAD", 7, 4); 
INSERT INTO SUBJECT VALUES ("10CS72","ECS", 7, 4); 
INSERT INTO SUBJECT VALUES ("10CS73","PTW", 7, 4); 
INSERT INTO SUBJECT VALUES ("10CS74","DWDM", 7, 4); 
INSERT INTO SUBJECT VALUES ("10CS75","JAVA", 7, 4); 
INSERT INTO SUBJECT VALUES ("10CS76","SAN", 7, 4);
INSERT INTO SUBJECT VALUES ("15CS51", "ME", 5, 4); 
INSERT INTO SUBJECT VALUES ("15CS52","CN", 5, 4); 
INSERT INTO SUBJECT VALUES ("15CS53","DBMS", 5, 4); 
INSERT INTO SUBJECT VALUES ("15CS54","ATC", 5, 4); 
INSERT INTO SUBJECT VALUES ("15CS55","JAVA", 5, 3); 
INSERT INTO SUBJECT VALUES ("15CS56","AI", 5, 3); 
INSERT INTO SUBJECT VALUES ("15CS41","M4", 4, 4); 
INSERT INTO SUBJECT VALUES ("15CS42","SE", 4, 4);
INSERT INTO SUBJECT VALUES ("15CS43","DAA", 4, 4); 
INSERT INTO SUBJECT VALUES ("15CS44","MPMC", 4, 4); 
INSERT INTO SUBJECT VALUES ("15CS45","OOC", 4, 3); 
INSERT INTO SUBJECT VALUES ("15CS46","DC", 4, 3);
INSERT INTO SUBJECT VALUES ("15CS31","M3", 3, 4); 
INSERT INTO SUBJECT VALUES ("15CS32","ADE", 3, 4); 
INSERT INTO SUBJECT VALUES ("15CS33","DSA", 3, 4); 
INSERT INTO SUBJECT VALUES ("15CS34","CO", 3, 4); 
INSERT INTO SUBJECT VALUES ("15CS35","USP", 3, 3); 
INSERT INTO SUBJECT VALUES ("15CS36","DMS", 3, 3);






INSERT INTO IAMARKS (USN, SUBCODE, SSID, TEST1, TEST2, TEST3) VALUES 
("1AP13CS091","10CS81","CSE8C", 15, 16, 18);
INSERT INTO IAMARKS (USN, SUBCODE, SSID, TEST1, TEST2, TEST3) VALUES 
("1AP13CS091","10CS82","CSE8C", 12, 19, 14);
INSERT INTO IAMARKS (USN, SUBCODE, SSID, TEST1, TEST2, TEST3) VALUES 
("1AP13CS091","10CS83","CSE8C", 19, 15, 20);
INSERT INTO IAMARKS (USN, SUBCODE, SSID, TEST1, TEST2, TEST3) VALUES 
("1AP13CS091","10CS84","CSE8C", 20, 16, 19);
INSERT INTO IAMARKS (USN, SUBCODE, SSID, TEST1, TEST2, TEST3) VALUES 
("1AP13CS091","10CS85","CSE8C", 15, 15, 12);


SELECT S.*, SS.SEM, SS.SEC
FROM STUDENT S, SEMSEC SS, CLASS C
WHERE S.USN = C.USN AND
SS.SSID =C.SSID AND
SS.SEM = 4 AND
SS.SEc="C";


SELECT SS.SEM, SS.SEC, S.GENDER, COUNT(S.GENDER) AS COUNT
FROM STUDENT S, SEMSEC SS, CLASS C
WHERE S.USN = C.USN AND
SS.SSID = C.SSID
GROUP BY SS.SEM, SS.SEC, S.GENDER
ORDER BY SEM;


CREATE VIEW STU_TEST1_MARKS_VIEW
AS
SELECT TEST1, SUBCODE
FROM IAMARKS
WHERE USN = "1CE16CS001";


 delimiter #
 CREATE PROCEDURE CalFA( )
 BEGIN
 UPDATE IAMARKS
 SET FINALIA = (CASE WHEN GREATEST(TEST1, TEST2) != GREATEST(TEST1,TEST3)
 THEN GREATEST(TEST1, TEST2) + GREATEST(TEST1,TEST3)
 ELSE
 GREATEST(TEST1, TEST2) + GREATEST(TEST2,TEST3)
 END) / 2
 WHERE FINALIA IS NULL;
 END #
delimiter ;
call CalFA( );
SELECT * FROM IAMARKS;


SELECT USN, SNAME, SUBCODE,FINALIA,
(CASE WHEN FINALIA BETWEEN 17 AND 20
THEN "OUTSTANDING"
WHEN FINALIA BETWEEN 12 AND 16
THEN "AVERAGE"
ELSE "WEAK"
END) AS CATEGORY
FROM (STUDENT natural join IAMARKS) natural join SEMSEC
WHERE SEM=8 AND SEC IN("A","B","C");

COMMIT;





















































CREATE DATABASE ALL5;
USE ALL5;

CREATE TABLE EMPLOYEE(SSN CHAR(5) PRIMARY KEY, FNAME VARCHAR(15),
LNAME VARCHAR(15), ADDRESS VARCHAR(15), SEX CHAR(1), SALARY
DECIMAL(8,2), SUPERSSN CHAR(5), DNO INT);

CREATE TABLE DEPARTMENT(DNO INT PRIMARY KEY, DNAME VARCHAR(10),
MGRSSN CHAR(5), MGRSTARTDATE DATE);


CREATE TABLE DLOCATION(DNO INT, DLOC VARCHAR(15), PRIMARY KEY(DNO,
DLOC));


CREATE TABLE PROJECT(PNO INT(5) PRIMARY KEY, PNAME VARCHAR(15),
PLOCATION VARCHAR(15), DNO INT);


CREATE TABLE WORKS_ON(SSN CHAR(5), PNO INT(5), HOURS INT(2), PRIMARY
KEY(SSN, PNO));

ALTER TABLE EMPLOYEE ADD CONSTRAINT FKSUPERSSN FOREIGN KEY(SUPERSSN)
REFERENCES EMPLOYEE(SSN);

ALTER TABLE EMPLOYEE ADD CONSTRAINT FKDNUMBER FOREIGN KEY(DNO)
REFERENCES DEPARTMENT(DNO);

ALTER TABLE DEPARTMENT ADD CONSTRAINT FKMGRSSN FOREIGN KEY(MGRSSN)
REFERENCES EMPLOYEE(SSN);

ALTER TABLE DLOCATION ADD CONSTRAINT FKLOCATION FOREIGN KEY(DNO)
REFERENCES DEPARTMENT(DNO);

ALTER TABLE PROJECT ADD CONSTRAINT FKPROJDEPT FOREIGN KEY(DNO) REFERENCES
DEPARTMENT(DNO);

ALTER TABLE WORKS_ON ADD CONSTRAINT FKWORKSPROJ FOREIGN KEY(PNO)
REFERENCES PROJECT(PNO);

ALTER TABLE WORKS_ON ADD CONSTRAINT FKWORKSEMP FOREIGN KEY(SSN)
REFERENCES EMPLOYEE(SSN);




INSERT INTO EMPLOYEE VALUES
("CEC01","JOHN","SCOTT","DALLAS,HOUSTON","M",850000,NULL,NULL),
("CEC02","JAMES","BORG","VOSS,HOUSTON","M",770000,NULL,NULL),
("CEC03","ALICIA","ZELEYA","CASTIE, SPRING","F",780000,NULL,NULL),
("CEC04","RAMESH","NARAYAN","BANGLORE","M",800000,NULL,NULL),
("CEC05","REENA","SHARMA","MUMBAI","F",580000,NULL,NULL),
("CEC06","ADITYA","ROY","JAIPUR","M",850000,NULL,NULL);

INSERT INTO DEPARTMENT VALUES
(1,"APPDEV","CEC01","2000-06-01"),
(2,"ACCOUNTS","CEC04","2000-05-25"),
(3,"ROBOTICS","CEC06","2015-02-05"),
(4,"TESTING","CEC01","2000-05-25"),
(5,"ES","CEC06","2014-11-25");

UPDATE EMPLOYEE SET DNO=1 WHERE SSN="CEC01";
UPDATE EMPLOYEE SET DNO=3 WHERE SSN="CEC02";
UPDATE EMPLOYEE SET DNO=4 WHERE SSN="CEC03";
UPDATE EMPLOYEE SET DNO=2 WHERE SSN="CEC04";
UPDATE EMPLOYEE SET DNO=5 WHERE SSN="CEC05";
UPDATE EMPLOYEE SET DNO=3 WHERE SSN="CEC06";

UPDATE EMPLOYEE SET SUPERSSN="CEC06" WHERE SSN="CEC01";
UPDATE EMPLOYEE SET SUPERSSN="CEC01" WHERE SSN="CEC03";
UPDATE EMPLOYEE SET SUPERSSN="CEC05" WHERE SSN="CEC02";
UPDATE EMPLOYEE SET SUPERSSN="CEC06" WHERE SSN="CEC05";

INSERT INTO DLOCATION VALUES(1,"TEXAS"),(2,"MUMBAI"),
(3,"NEW JERSEY"),(3,"JAIPUR"),(4,"BANGALORE"),(5,"NEW JERSEY");

INSERT INTO PROJECT VALUES(111,"IOT","BANGALORE", 1),
(222,"INSAT","JAIPUR", 5),
(333,"UDAN","JAIPUR", 5),
(444,"METALDETECTOR","TEXAS", 3),
(555,"WARFEILDSPYING","TEXAS", 3);


INSERT INTO WORKS_ON VALUES("CEC01", 111, 30),
("CEC02", 222, 15),("CEC02", 333, 15),
("CEC03", 444, 12),("CEC03", 555, 18),
("CEC05", 333, 20),("CEC05", 555, 10),
("CEC06", 222, 10),("CEC06", 444, 20),
("CEC01", 555, 10);


(SELECT PNO
FROM PROJECT P,DEPARTMENT D,EMPLOYEE E 
WHERE P.DNO= D.DNO AND D.MGRSSN=E.SSN AND E.LNAME="SCOTT")
UNION
(SELECT PNO
FROM WORKS_ON W,EMPLOYEE E 
WHERE E.SSN =E.SSN AND E.LNAME="SCOTT");


SELECT E.FNAME,E.SALARY,1.1*E.SALARY INC_SALARY
FROM EMPLOYEE E,PROJECT P,WORKS_ON W
WHERE E.SSN=W.SSN AND P.PNO=W.PNO AND P.PNAME="IOT";



SELECT DNAME,SUM(SALARY) TOT_SAL,MAX(SALARY) MAX_SAL,
MIN(SALARY) MIN_SAL,AVG(SALARY) AVG_SAL
FROM EMPLOYEE NATURAL JOIN DEPARTMENT
WHERE DNAME="ACCOUNTS";


SELECT E.FNAME 
FROM EMPLOYEE E
WHERE NOT EXISTS(SELECT P.PNO
FROM PROJECT P
WHERE P.DNO=5 AND 
P.PNO NOT IN (SELECT W.PNO
FROM WORKS_ON W  
WHERE E.SSN=W.SSN));





SELECT * FROM EMPLOYEE;


SELECT DNO,COUNT(*)
FROM EMPLOYEE
WHERE 
DNO IN (SELECT DNO 
FROM EMPLOYEE 
GROUP BY DNO 
HAVING COUNT(*)>5)
AND 
SALARY>60000
GROUP BY DNO;

SELECT DNO,COUNT(*)
FROM EMPLOYEE
WHERE 
DNO IN (SELECT DNO 
FROM EMPLOYEE 
GROUP BY DNO 
HAVING COUNT(*)>1)
AND 
SALARY>60000
GROUP BY DNO;

COMMIT;
